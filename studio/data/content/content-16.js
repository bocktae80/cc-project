window.STUDIO_CONTENT = window.STUDIO_CONTENT || {};
window.STUDIO_CONTENT["16-background-agents"] = {
  overview: `## 백그라운드 에이전트 — 여러 작업을 동시에 처리하기

요리사가 국 끓이면서 동시에 야채도 썰듯, **여러 작업을 동시에** 처리할 수 있어요!
국이 끓는 동안 가만히 기다리지 않고, 다른 요리를 준비하는 거예요.

Claude Code에서도 테스트를 돌리면서 코드를 고치고,
서버를 실행하면서 파일을 수정하는 게 가능합니다.

### 포그라운드 vs 백그라운드

\`\`\`
포그라운드 (하나씩)                 백그라운드 (동시에)
──────────────────                ────────────────────
[테스트 실행]                       [테스트 실행 (뒤에서)]
   ⋮ 기다리기...                    [코드 수정 (앞에서)]
   ⋮ (아무것도 못함)                    ⋮ 동시 진행!
[완료]                               ⋮
[이제야 코드 수정]                  [테스트 완료 알림!]
                                   [코드 수정 계속]
\`\`\`

### 핵심 학습 내용

| 개념 | 설명 | 비유 |
|------|------|------|
| 포그라운드 | 앞에서 실행, 끝날 때까지 대기 | 라면 끓이며 지켜보기 |
| 백그라운드 | 뒤에서 실행, 다른 작업 가능 | 밥솥에 밥 맡기기 |
| run_in_background | 명령을 백그라운드로 보내는 옵션 | 밥솥 타이머 설정 |
| TaskOutput | 백그라운드 작업 결과 확인 | 밥솥 완료 알림 |`,

  concepts: [
    {
      id: "foreground-vs-background",
      title: "포그라운드 vs 백그라운드",
      content: `### 라면 지켜보기 vs 밥솥에 맡기기

#### 포그라운드 = 라면 끓이며 앞에서 지켜보기

\`\`\`
[시작] 라면 물 올리기
  |
  | 3분... 기다리기
  | (다른 일 못함!)
  |
[완료] 라면 완성

→ 이제야 반찬 준비 시작
\`\`\`

#### 백그라운드 = 밥솥에 밥 맡기고 반찬 만들기

\`\`\`
[시작] 밥솥에 밥 넣기        [시작] 반찬 만들기
  |                           |
  | 밥솥이 알아서             | 동시에 진행!
  | 돌아감                    | 야채 썰기
  |                           | 계란 부치기
  |                           |
[삐-삐] 밥 완료!             [완료] 반찬도 완성!
\`\`\`

#### 비교표

| 비교 항목 | 포그라운드 | 백그라운드 |
|-----------|-----------|-----------|
| 비유 | 라면 지켜보기 | 밥솥에 맡기기 |
| 다른 작업 | 불가능 (대기 중) | **가능** |
| 결과 확인 | 즉시 (화면에 표시) | 나중에 (알림/확인) |
| 적합한 작업 | 빠른 작업 (5초 이내) | 오래 걸리는 작업 |
| 예시 | \`git status\`, \`ls\` | \`npm test\`, \`npm run build\` |

#### 언제 백그라운드를 쓸까?

\`\`\`
빠른 작업 (5초 이내)
├── 포그라운드로! (기다려도 됨)
└── 예: git status, 파일 읽기

오래 걸리는 작업 (30초+)
├── 백그라운드로! (기다리는 동안 다른 일)
└── 예: 테스트 실행, 빌드, 서버 실행

매우 오래 걸리는 작업 (5분+)
├── & prefix (클라우드)도 고려! (13번 텔레포트)
└── 예: 대규모 리팩토링, 전체 분석
\`\`\``
    },
    {
      id: "run-in-background",
      title: "run_in_background 파라미터와 TaskOutput",
      content: `### 밥솥 타이머 설정하기 = run_in_background

Bash 도구에는 \`run_in_background\` 옵션이 있어요.
이걸 켜면 명령이 **뒤에서 실행**되고, 앞에서는 다른 작업을 할 수 있어요.

#### 사용법

\`\`\`
Bash 도구 호출 시:
{
  "command": "npm test",
  "run_in_background": true    ← 이 옵션!
}
\`\`\`

#### 작동 흐름

\`\`\`
[1] 백그라운드 명령 전송
    "npm test를 백그라운드로 실행해줘"
         |
         v
[2] 바로 다른 작업 가능!
    "src/utils.ts를 수정해줘"
         |
         | (테스트가 뒤에서 돌아가는 중...)
         |
[3] 완료 알림 수신
    "백그라운드 작업 완료: npm test (45초, 통과)"
         |
         v
[4] 결과 확인
    TaskOutput으로 상세 로그 확인
\`\`\`

#### TaskOutput = 밥솥 뚜껑 열어보기

\`\`\`
TaskOutput 사용:
→ 백그라운드 작업의 결과를 확인하는 도구
→ "밥이 다 됐나?" 확인하는 것과 같음

확인 가능한 정보:
- 실행 상태 (진행 중/완료/실패)
- 출력 로그 (stdout/stderr)
- 실행 시간
- 종료 코드 (0 = 성공, 1 = 실패)
\`\`\`

#### & prefix vs run_in_background

| 비교 | \`&\` prefix (13번 텔레포트) | \`run_in_background\` |
|------|------------------------|---------------------|
| 실행 위치 | **클라우드** | **로컬 (내 컴퓨터)** |
| 네트워크 필요 | 예 | 아니요 |
| 터미널 닫아도 | 계속 실행 | **중단됨** |
| 적합한 작업 | 대규모 분석, 리팩토링 | 테스트, 빌드, 서버 |
| 결과 확인 | /teleport | TaskOutput |`
    },
    {
      id: "task-management",
      title: "Ctrl+C 처리와 작업 관리",
      content: `### 여러 요리를 동시에 관리하기

요리사도 한꺼번에 10가지 요리를 하면 정신없겠죠?
백그라운드 작업도 **적절히 관리**해야 해요.

#### 작업 중단하기 (Ctrl+C)

\`\`\`
현재 포그라운드 작업을 중단하려면:
→ Ctrl+C (키보드)

결과:
- 포그라운드 작업: 즉시 중단
- 백그라운드 작업: 영향 없음 (계속 실행)
\`\`\`

#### 백그라운드 작업 관리

\`\`\`
작업 목록 확인
┌──────────────────────────────────────┐
│ ID │ 상태    │ 명령         │ 시간   │
├──────────────────────────────────────┤
│  1 │ 실행 중  │ npm test    │ 1분 23초│
│  2 │ 완료    │ npm build   │ 45초   │
│  3 │ 실행 중  │ dev server  │ 5분 10초│
└──────────────────────────────────────┘
\`\`\`

#### 동시 작업 권장 수

\`\`\`
동시 작업 수     상태
────────────    ────────
1-2개           적절 (관리 쉬움)
3-4개           주의 (시스템 부하 가능)
5개 이상         위험 (메모리 부족 가능!)

권장: 2-3개가 최적!
\`\`\`

#### 백그라운드 작업 선택 가이드

\`\`\`
이 작업을 백그라운드로 돌릴까?
├── 30초 이상 걸리는가?
│   ├── 예 → 백그라운드 추천!
│   └── 아니요 → 포그라운드로 충분
│
├── 작업 중간에 입력이 필요한가?
│   ├── 예 → 포그라운드 (대화형)
│   └── 아니요 → 백그라운드 가능
│
└── 터미널 닫아도 되는가?
    ├── 예 → & prefix 추천 (클라우드)
    └── 아니요 → run_in_background
\`\`\``
    }
  ],

  tutorials: [
    {
      id: "step-01",
      title: "첫 백그라운드 명령 실행",
      content: `### 밥솥에 밥 넣기 = 첫 백그라운드 실행

가장 기본적인 백그라운드 실행을 해봅시다.
Bash 도구에 \`run_in_background: true\`를 설정하면 됩니다.

#### 기본 사용법

\`\`\`bash
# 포그라운드 (기본) - 끝날 때까지 기다림
npm test

# 백그라운드 - 바로 다음 작업 가능
# (Claude에게 "백그라운드로 실행해줘"라고 요청)
npm test  # run_in_background: true
\`\`\`

#### 자연어 요청 예시

\`\`\`
"npm test를 백그라운드로 실행해줘"
"테스트를 뒤에서 돌려줘"
"빌드를 백그라운드로 시작해줘"
\`\`\`

#### 주의사항

| 상황 | 권장 |
|------|------|
| \`git status\` (즉시 완료) | 포그라운드 |
| \`npm test\` (30초~2분) | 백그라운드 |
| \`npm run dev\` (계속 실행) | 백그라운드 |
| 사용자 입력 필요 | 포그라운드 |`,
      terminals: [
        {
          command: "# 테스트를 백그라운드로 실행",
          output: `> npm test를 백그라운드로 실행해줘

Claude: 테스트를 백그라운드에서 실행합니다.

[Background] npm test 실행 중...
Task ID: bg-001

다른 작업을 진행할 수 있습니다.
결과는 완료 시 알려드리겠습니다.

> (바로 다른 요청 가능!)
> src/utils.ts에서 formatDate 함수를 수정해줘

Claude: formatDate 함수를 수정합니다...
(테스트가 뒤에서 계속 돌아가는 중!)

[파일 수정 완료: src/utils.ts]

---
[Background 완료] npm test (Task bg-001)
실행 시간: 47초
결과: 24 tests passed, 0 failed`
        }
      ]
    },
    {
      id: "step-02",
      title: "에이전트를 백그라운드로 실행",
      content: `### 부엌 보조 요리사 = 백그라운드 에이전트

Bash 명령뿐 아니라, **에이전트(Task) 자체도 백그라운드로** 실행할 수 있어요.
마치 보조 요리사에게 "이 요리 맡아줘"라고 시키는 것처럼!

#### Bash vs Agent 백그라운드

\`\`\`
Bash 백그라운드                  Agent 백그라운드
─────────────────               ──────────────────
단순 명령 실행                    복잡한 작업 위임
"npm test 돌려"                  "이 코드를 분석해줘"
결과: 출력 로그                   결과: 분석 보고서
빠르게 끝나는 작업                시간이 걸리는 AI 작업
\`\`\`

#### 에이전트 백그라운드 사용 예시

\`\`\`bash
# Claude에게 요청
> "이 프로젝트의 아키텍처를 백그라운드에서 분석해줘.
   그동안 나는 README를 수정할게."
\`\`\`

#### 병렬 작업 패턴

\`\`\`
[메인 작업]          [백그라운드 에이전트]
코드 수정             코드 리뷰 분석
README 작성           테스트 커버리지 계산
커밋 준비             의존성 보안 점검
    └──────── 결과 합류 ────────┘
              최종 커밋
\`\`\``,
      terminals: [
        {
          command: "# 에이전트를 백그라운드로 실행",
          output: `> 이 프로젝트의 코드 품질을 백그라운드에서 분석해줘.
  그동안 나는 README를 수정할 거야.

Claude: 코드 품질 분석을 백그라운드 에이전트로 시작합니다.

[Background Agent] 코드 품질 분석 시작...
Task ID: agent-001

진행하실 작업을 말씀해주세요.

> README.md의 설치 방법 섹션을 업데이트해줘

Claude: README.md를 수정합니다...
[파일 수정 완료: README.md]

---
[Background Agent 완료] 코드 품질 분석 (agent-001)
실행 시간: 2분 15초

=== 코드 품질 보고서 ===
파일 수: 42개
평균 복잡도: 3.2 (양호)
테스트 커버리지: 78%
미사용 변수: 5개
긴 함수 (50줄+): 3개

상세 보고서를 확인하시겠습니까?`
        },
        {
          command: "# 결과 확인 (TaskOutput)",
          output: `> 방금 백그라운드 분석 결과를 자세히 보여줘

Claude: 백그라운드 에이전트 결과를 확인합니다.

=== 상세 코드 품질 보고서 ===

[미사용 변수] (5건)
  1. src/utils.ts:23 - tempResult
  2. src/api.ts:45 - debugMode
  3. src/config.ts:12 - oldEndpoint
  4. src/auth.ts:67 - retryCount
  5. src/logger.ts:8 - logLevel

[긴 함수] (3건)
  1. src/parser.ts:parseDocument (82줄)
  2. src/validator.ts:validateAll (65줄)
  3. src/renderer.ts:renderPage (57줄)

권장 조치:
  - 미사용 변수 5개 제거
  - 긴 함수 3개를 작은 함수로 분리`
        }
      ]
    },
    {
      id: "step-03",
      title: "여러 백그라운드 작업 동시 관리",
      content: `### 여러 요리를 동시에! 멀티태스킹 마스터

국 끓이기, 야채 썰기, 밥 짓기를 동시에 하듯
여러 백그라운드 작업을 동시에 관리해 봅시다.

#### 동시 실행 패턴

\`\`\`
시간축 →
────────────────────────────────────────

[bg-001] npm test ████████████░░░ (진행 중)
[bg-002] npm build ████████████████ (완료!)
[bg-003] dev server ████████████████████ (계속 실행)
[포그라운드] 코드 수정 중...
\`\`\`

#### 작업 조합 추천

\`\`\`
추천 조합 (2-3개)
─────────────────
1. 테스트 + 코드 수정
2. 빌드 + 문서 작성
3. 서버 실행 + 코드 수정 + 테스트

비추천 조합 (과부하)
─────────────────
X. 테스트 + 빌드 + 서버 + 분석 + 리팩토링
   → 시스템 느려짐, 관리 어려움
\`\`\`

#### 동시 작업 관리 명령

\`\`\`bash
# 여러 작업 시작
> "npm test를 백그라운드로 돌리고,
   동시에 src/api.ts를 수정해줘"

# 작업 상태 확인
> "현재 백그라운드 작업 상태를 알려줘"

# 특정 작업 중단
> "bg-001 테스트 작업을 중단해줘"
\`\`\``,
      terminals: [
        {
          command: "# 여러 백그라운드 작업 동시 실행",
          output: `> npm test를 백그라운드로 돌리고, 동시에 npm run lint도
  백그라운드로 실행해줘. 그동안 나는 코드를 수정할게.

Claude: 두 작업을 백그라운드에서 시작합니다.

[Background] npm test 실행 중... (Task bg-001)
[Background] npm run lint 실행 중... (Task bg-002)

두 작업이 백그라운드에서 실행 중입니다.
다른 작업을 진행해주세요.

> src/api.ts의 에러 처리를 개선해줘

Claude: src/api.ts를 수정합니다...
[파일 수정 완료: src/api.ts]

---
[Background 완료] npm run lint (Task bg-002)
실행 시간: 12초
결과: 2 warnings, 0 errors

---
[Background 완료] npm test (Task bg-001)
실행 시간: 48초
결과: 24 tests passed, 0 failed

> 모든 백그라운드 작업 완료!`
        },
        {
          command: "# 개발 서버 + 코드 수정 병렬 실행",
          output: `> 개발 서버를 백그라운드로 실행하고,
  그동안 로그인 페이지를 수정해줘

Claude: 개발 서버를 백그라운드에서 시작합니다.

[Background] npm run dev 실행 중... (Task bg-003)
Server running at http://localhost:3000

로그인 페이지를 수정합니다...

[파일 수정: src/pages/Login.tsx]
  - 이메일 유효성 검사 추가
  - 에러 메시지 UI 개선
  - 로딩 상태 표시 추가
[파일 수정 완료]

개발 서버(bg-003)가 계속 실행 중이므로
http://localhost:3000/login에서 변경사항을 확인할 수 있습니다.

> 서버를 중단하려면 "bg-003을 중단해줘"라고 말씀해주세요.`
        }
      ]
    }
  ],

  examples: [
    {
      id: "test-and-code",
      title: "테스트 실행 + 코드 작성 동시 진행",
      content: `### 테스트 돌리면서 코드 고치기

가장 흔하게 쓰이는 백그라운드 패턴입니다.
테스트가 돌아가는 동안 코드를 수정하면 시간을 절약할 수 있어요.

#### 시나리오 흐름

\`\`\`
[순서]

1. 현재 코드의 테스트를 백그라운드로 실행
   > "npm test를 백그라운드로 돌려줘"

2. 테스트 돌아가는 동안 새 기능 코드 작성
   > "src/features/search.ts에 검색 기능을 추가해줘"

3. 테스트 완료 알림 확인
   [bg 완료] 24 tests passed

4. 새 기능에 대한 테스트 추가
   > "search.ts에 대한 테스트도 작성해줘"

5. 다시 전체 테스트 실행
   > "npm test를 다시 백그라운드로 돌려줘"
\`\`\`

#### 시간 절약 효과

\`\`\`
순차 실행 (포그라운드)             병렬 실행 (백그라운드)
──────────────────              ──────────────────
테스트 실행 (2분)                 테스트 (2분)  + 코드 작성 (5분)
 ⋮ 대기...                                      동시 진행!
코드 작성 (5분)
테스트 실행 (2분)                 테스트 (2분)
 ⋮ 대기...
────────────                    ─────────────
총 9분                           총 7분 (22% 절약!)
\`\`\`

> **팁**: watch 모드(\`npm test -- --watch\`)를 백그라운드로 돌리면 파일 변경 시 자동 재실행!`,
      checklist: [
        "테스트를 백그라운드로 실행할 수 있다",
        "테스트 실행 중에 다른 코드를 수정할 수 있다",
        "백그라운드 작업 완료 알림을 확인할 수 있다",
        "순차 실행 대비 시간 절약 효과를 이해한다"
      ]
    },
    {
      id: "dev-server-workflow",
      title: "개발 서버 + 코드 수정 병렬 워크플로우",
      content: `### 서버 켜놓고 코드 고치기

개발 서버를 백그라운드로 돌리면서 코드를 수정하는 실전 패턴입니다.

#### 실전 워크플로우

\`\`\`
[1단계] 서버 시작
> "npm run dev를 백그라운드로 실행해줘"
→ 서버가 localhost:3000에서 실행

[2단계] 코드 수정
> "헤더 컴포넌트의 네비게이션을 수정해줘"
→ 수정 완료, HMR(Hot Module Replacement)로 자동 반영

[3단계] 브라우저 확인 (15번과 연동!)
> "localhost:3000의 스크린샷을 찍어줘"
→ 수정 결과 즉시 확인

[4단계] 반복
> "이번에는 푸터를 수정해줘"
→ 수정 → 확인 → 수정 → 확인
\`\`\`

#### 개발 서버 관리

\`\`\`
서버 상태 확인
> "개발 서버가 아직 실행 중인지 확인해줘"

서버 중단
> "개발 서버를 중단해줘"

서버 재시작
> "개발 서버를 재시작해줘"
\`\`\`

#### 백그라운드 활용 조합

\`\`\`
초보자 패턴:                     고급자 패턴:
───────────                     ───────────
서버 (백그라운드)                  서버 (백그라운드)
  + 코드 수정                       + 테스트 (백그라운드)
                                    + 코드 수정 (포그라운드)
                                    + 브라우저 확인 (15번)
\`\`\`

> **팁**: 개발 서버 + 브라우저 자동화(15번)를 조합하면, 코드 수정 → 즉시 확인이 가능해요!`,
      checklist: [
        "개발 서버를 백그라운드로 실행할 수 있다",
        "서버 실행 중에 코드를 수정할 수 있다",
        "서버 상태를 확인하고 중단할 수 있다",
        "개발 서버 + 테스트 + 코드 수정 조합을 활용할 수 있다"
      ]
    }
  ],

  quiz: [
    {
      question: "포그라운드와 백그라운드의 가장 큰 차이는?",
      options: [
        "백그라운드가 더 빠르게 실행된다",
        "포그라운드는 끝날 때까지 대기해야 하고, 백그라운드는 다른 작업이 가능하다",
        "포그라운드는 에러가 더 적다"
      ],
      answer: 1,
      explanation: "포그라운드는 작업이 끝날 때까지 기다려야 하지만, 백그라운드는 작업이 뒤에서 실행되는 동안 다른 작업을 할 수 있습니다. 밥솥에 밥을 맡기고 반찬을 만드는 것과 같아요."
    },
    {
      question: "백그라운드 작업의 결과를 확인하는 방법은?",
      options: [
        "Ctrl+C를 눌러 작업을 중단하면 결과가 나온다",
        "작업 완료 시 자동 알림이 오거나, TaskOutput으로 확인한다",
        "브라우저에서 확인해야 한다"
      ],
      answer: 1,
      explanation: "백그라운드 작업이 완료되면 자동으로 알림이 오고, TaskOutput 도구를 사용하면 중간 결과나 상세 로그도 확인할 수 있습니다."
    },
    {
      question: "& prefix(텔레포트)와 run_in_background의 핵심 차이는?",
      options: [
        "& prefix가 더 빠르다",
        "& prefix는 클라우드에서, run_in_background는 로컬에서 실행된다",
        "run_in_background는 결과를 확인할 수 없다"
      ],
      answer: 1,
      explanation: "& prefix(13번 텔레포트)는 작업을 클라우드로 보내서 실행하고, run_in_background는 내 컴퓨터(로컬)에서 실행합니다. 터미널을 닫으면 로컬 백그라운드는 중단되지만, 클라우드는 계속 실행돼요."
    },
    {
      question: "동시에 실행하는 백그라운드 작업의 권장 수는?",
      options: [
        "많을수록 좋다 (10개 이상)",
        "2-3개가 적절하다",
        "항상 1개만 실행해야 한다"
      ],
      answer: 1,
      explanation: "백그라운드 작업이 너무 많으면 시스템이 느려지고 관리도 어려워집니다. 2-3개가 적절하고, 5개 이상은 메모리 부족 등의 문제가 생길 수 있어요."
    },
    {
      question: "다음 중 백그라운드 실행에 가장 적합한 작업은?",
      options: [
        "git status (즉시 완료되는 명령)",
        "npm test (30초~2분 걸리는 테스트 실행)",
        "파일 내용 물어보기 (대화형 작업)"
      ],
      answer: 1,
      explanation: "npm test처럼 시간이 걸리면서 사용자 입력이 필요 없는 작업이 백그라운드에 적합합니다. git status는 즉시 끝나서 굳이 백그라운드가 필요 없고, 대화형 작업은 포그라운드에서 해야 해요."
    }
  ]
};
