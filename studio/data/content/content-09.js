window.STUDIO_CONTENT = window.STUDIO_CONTENT || {};
window.STUDIO_CONTENT["09-worktree"] = {
  overview: `## Worktree — 안전한 실험 공간 만들기

코드를 고치다가 "이거 완전히 망하면 어떡하지?" 걱정한 적 있나요?

**워크트리(Worktree)**는 코드의 **과학 실험실**입니다.
원래 코드는 안전하게 책상 위에 두고, 별도의 실험실에서 마음껏 시도해볼 수 있어요!

### 핵심 비유

\`\`\`
나의 책상 (= main 코드)              실험실 (= worktree)
━━━━━━━━━━━━━━━━━━━━━              ━━━━━━━━━━━━━━━━━━━━

  ┌──────────────┐                   ┌──────────────┐
  │  보고서.txt   │                   │  보고서.txt   │  ← 복사본!
  │  자료.csv     │                   │  자료.csv     │
  │  분석.py      │                   │  분석.py      │
  └──────────────┘                   └──────────────┘

  손대지 않음!                        여기서 마음껏 실험!
  안전하게 보존                       실패해도 OK
\`\`\`

- 실험 성공하면 결과를 책상(main)으로 가져오기
- 실험 실패하면 실험실만 정리하면 끝!`,

  concepts: [
    {
      id: "what-is-worktree",
      title: "워크트리란? (과학 실험실)",
      content: `### 과학 실험실 비유로 이해하기

학교 과학 시간에 위험한 실험을 할 때, 교실 책상이 아닌 **별도의 실험대**에서 하죠?

워크트리도 똑같습니다:

| 과학 실험실 | 워크트리 |
|------------|---------|
| 내 책상 | main 코드 (원본) |
| 별도 실험대 | 워크트리 폴더 (복사본) |
| 실험 재료 | 코드 파일들 |
| 실험 성공 → 보고서에 반영 | 성공 → main에 머지 |
| 실험 실패 → 실험대 정리 | 실패 → 워크트리 삭제 |

#### 워크트리의 핵심 특징

1. **완전 격리**: 실험실에서 뭘 하든 내 책상은 안전
2. **동시 존재**: 책상과 실험대가 동시에 존재 (둘 다 열어볼 수 있음)
3. **독립 작업**: 실험실에서 자유롭게 코드를 바꿔도 원본에 영향 없음
4. **쉬운 정리**: 실패하면 폴더만 삭제하면 끝

#### 워크트리 폴더 위치

\`\`\`
프로젝트/
├── .claude/
│   └── worktrees/        ← 여기에 실험실이 생성됨
│       └── my-experiment/  ← 실험실 하나
│           ├── 보고서.txt   ← 복사된 파일들
│           ├── 자료.csv
│           └── 분석.py
├── 보고서.txt              ← 원본 (안전!)
├── 자료.csv
└── 분석.py
\`\`\`

> **참고**: 워크트리는 Git 저장소 안에서만 사용할 수 있습니다.`
    },
    {
      id: "worktree-vs-branch",
      title: "브랜치 전환 vs 워크트리",
      content: `### 서류 교체 vs 실험대 추가

브랜치 전환과 워크트리의 차이를 비유로 이해해봅시다.

#### 브랜치 전환 = 책상 위 서류 교체

\`\`\`
1. 수학 공부 중... (main 브랜치)
   책상: [수학책] [수학노트] [계산기]

2. "과학 숙제 해야지!" (git checkout science)
   → 수학 서류 치우고, 과학 서류 꺼냄
   책상: [과학책] [실험보고서] [시약목록]

3. 문제: 수학과 과학을 동시에 못 함!
\`\`\`

#### 워크트리 = 옆에 실험대 하나 더

\`\`\`
1. 수학 공부 중... (main 코드)
   내 책상:  [수학책] [수학노트] [계산기]

2. "과학 실험도 해야지!" (claude --worktree)
   → 옆에 실험대를 하나 더 만듦!
   내 책상:  [수학책] [수학노트] [계산기]  ← 그대로!
   실험대:  [과학책] [실험보고서] [시약목록]  ← 새로 생김!

3. 두 가지를 동시에 할 수 있음!
\`\`\`

#### 비교표

| 비교 항목 | 브랜치 전환 | 워크트리 |
|-----------|-----------|---------|
| 비유 | 서류를 치우고 다른 서류 펼치기 | 옆에 실험대를 하나 더 만들기 |
| 작업 폴더 | **1개** (전환하며 사용) | **2개 이상** (동시 존재) |
| 전환 속도 | 느림 (파일 교체 필요) | 빠름 (이미 따로 존재) |
| 동시 작업 | 불가능 | 가능 |
| 위험도 | 충돌 가능 | 완전 격리, 안전 |`
    },
    {
      id: "agent-isolation",
      title: "에이전트 격리 실행",
      content: `### 각 에이전트에게 전용 실험실 주기

팀 프로젝트를 할 때 모두가 한 책상에서 작업하면 혼란스럽잖아요? 각자 **전용 실험대**가 있으면 훨씬 효율적입니다.

클로드 코드의 에이전트 팀도 마찬가지입니다. \`isolation: "worktree"\`를 설정하면 각 에이전트가 **자기만의 워크트리**에서 독립적으로 작업합니다.

#### 격리 없는 에이전트 vs 격리된 에이전트

\`\`\`
격리 없음 (위험!)                   격리 있음 (안전!)
━━━━━━━━━━━━━━━━                  ━━━━━━━━━━━━━━━━

  [에이전트A]                        [에이전트A] → 실험대A
      ↓                                 독립 작업
  [같은 폴더] ← 충돌!              [에이전트B] → 실험대B
      ↑                                 독립 작업
  [에이전트B]                        [에이전트C] → 실험대C
                                        독립 작업
\`\`\`

#### 설정 방법

\`\`\`json
{
  "name": "researcher",
  "model": "claude-sonnet-4-20250514",
  "isolation": "worktree"
}
\`\`\`

> **핵심**: 워크트리 격리를 사용하면 여러 에이전트가 같은 프로젝트에서 동시에 작업해도 서로 방해하지 않습니다!`
    }
  ],

  tutorials: [
    {
      id: "step-01",
      title: "첫 번째 워크트리 만들기",
      content: `### 실험실 만들기 — claude --worktree

가장 간단한 방법은 \`claude --worktree\` (또는 줄여서 \`claude -w\`)를 실행하는 것입니다.

#### 순서

1. Git 저장소 안에서 \`claude -w\` 실행
2. 워크트리가 자동 생성됨
3. 워크트리 안에서 자유롭게 작업
4. 세션 종료 시 워크트리 유지/삭제 선택`,
      terminals: [
        {
          command: "claude --worktree",
          output: `╭──────────────────────────────────────────────╮
│ Claude Code v2.1.50                          │
│ Worktree: .claude/worktrees/cyan-thunder     │
│ Branch: worktree/cyan-thunder (from main)    │
╰──────────────────────────────────────────────╯

> 워크트리에서 작업을 시작합니다!`
        },
        {
          command: "# 워크트리 안에서 자유롭게 코드 수정",
          output: `> index.js의 계산 로직을 완전히 새로 짜줘

(워크트리 안이므로 원본에 영향 없이 마음껏 수정 가능!)`
        },
        {
          command: "# 세션 종료 시",
          output: `워크트리를 유지하시겠습니까?
  [K] 유지 (나중에 계속 작업)
  [R] 삭제 (실험 끝, 정리)

> R

워크트리 삭제 완료. 원본 코드는 그대로입니다.`
        }
      ]
    },
    {
      id: "step-02",
      title: "안전한 실험하기",
      content: `### 실험실에서 과감하게 시도하기

워크트리의 핵심은 **"망쳐도 괜찮다"**는 것입니다.
평소라면 무서워서 못 했을 대담한 변경을 마음껏 해볼 수 있어요.

#### 시나리오: 프로젝트 구조 완전 변경 실험

원래 코드를 바꾸기 무섭다면 워크트리에서 먼저 실험!`,
      terminals: [
        {
          command: "claude -w",
          output: `╭──────────────────────────────────────────────╮
│ Worktree: .claude/worktrees/bold-experiment  │
│ Branch: worktree/bold-experiment (from main) │
╰──────────────────────────────────────────────╯`
        },
        {
          command: "# 워크트리에서 과감한 실험",
          output: `> 이 프로젝트의 폴더 구조를 완전히 바꿔줘.
> src/ 안의 모든 파일을 기능별로 재분류하고,
> import 경로도 전부 수정해줘.

Claude: 네, 워크트리 안이니 안심하고 진행하겠습니다!
(파일 20개 이동, import 경로 45개 수정...)

✅ 폴더 구조 변경 완료!
- src/components/ → src/ui/
- src/utils/ → src/shared/
- src/api/ → src/services/`
        },
        {
          command: "# 실험 결과 확인",
          output: `> npm test 실행해줘

테스트 결과: 48 passed, 2 failed

→ 실패한 테스트가 있네요. 수정하거나...
→ 실험 실패라면 워크트리만 삭제하면 됩니다!`
        },
        {
          command: "# 원본 확인 (책상은 안전!)",
          output: `> 원본 main 브랜치 확인
$ ls src/
components/  utils/  api/   ← 원래 구조 그대로!

(워크트리에서 아무리 바꿔도 원본은 안전합니다)`
        }
      ]
    },
    {
      id: "step-03",
      title: "에이전트 격리 실행하기",
      content: `### 각 에이전트에게 전용 실험실 배정하기

팀의 에이전트마다 전용 워크트리를 만들어주면, 동시에 작업해도 서로 방해하지 않습니다.

#### 시나리오: 프론트엔드/백엔드 동시 작업`,
      terminals: [
        {
          command: "# .claude/agents/frontend.md 설정",
          output: `---
name: frontend-dev
model: claude-sonnet-4-20250514
isolation: worktree
---

프론트엔드 UI 컴포넌트를 개발합니다.`
        },
        {
          command: "# .claude/agents/backend.md 설정",
          output: `---
name: backend-dev
model: claude-sonnet-4-20250514
isolation: worktree
---

백엔드 API를 개발합니다.`
        },
        {
          command: "# 팀 실행 결과",
          output: `프로젝트/
├── .claude/worktrees/
│   ├── frontend-dev-abc123/   ← 프론트엔드 전용 실험실
│   │   └── (UI 파일 수정 중...)
│   └── backend-dev-def456/    ← 백엔드 전용 실험실
│       └── (API 파일 수정 중...)
├── src/                        ← 원본 (안전!)
└── ...

두 에이전트가 동시에 작업해도 충돌 없음!`
        }
      ]
    }
  ],

  examples: [
    {
      id: "basic-worktree",
      title: "기본 워크트리 생성/확인/정리",
      content: `### 실험실 만들고, 확인하고, 정리하기

워크트리의 기본 라이프사이클을 따라해봅시다.

#### 워크트리 라이프사이클

\`\`\`
생성 → 작업 → 확인 → 판단 → 정리
 │              │            │
 │              │            ├── 성공: 머지 후 삭제
 │              │            └── 실패: 바로 삭제
 │              │
 │              └── git diff로 변경사항 확인
 │
 └── claude --worktree 또는 claude -w
\`\`\`

#### 주요 명령어

\`\`\`bash
# 워크트리 생성 (실험실 만들기)
claude --worktree
claude -w                # 줄임말

# 워크트리 목록 확인 (실험실 목록)
git worktree list

# 워크트리 삭제 (실험실 정리)
git worktree remove .claude/worktrees/이름

# 변경사항을 main에 머지 (실험 결과 반영)
git checkout main
git merge worktree/이름
\`\`\``,
      checklist: [
        "claude --worktree (또는 -w)로 워크트리를 생성할 수 있다",
        "워크트리가 .claude/worktrees/ 폴더에 생성되는 것을 이해한다",
        "워크트리에서의 변경이 원본에 영향을 주지 않는다는 것을 확인했다",
        "세션 종료 시 워크트리 유지/삭제를 선택할 수 있다",
        "에이전트 격리(isolation: worktree) 개념을 이해한다"
      ]
    },
    {
      id: "worktree-hooks",
      title: "워크트리 훅으로 자동화하기",
      content: `### 실험실 만들 때 자동으로 준비하기

과학 실험실에 들어가면 먼저 실험복을 입고, 안전 장비를 챙기죠?
워크트리 훅을 사용하면 **워크트리를 만들 때 자동으로 필요한 준비**를 할 수 있습니다.

#### 훅 종류

| 훅 | 시점 | 비유 |
|----|------|------|
| WorktreeCreate | 워크트리 생성 시 | 실험실 입장 → 실험복 입기 |
| WorktreeRemove | 워크트리 삭제 시 | 실험 끝 → 정리정돈 |

#### 설정 예시

\`\`\`json
{
  "hooks": {
    "WorktreeCreate": [
      {
        "command": "npm install",
        "description": "워크트리에 의존성 설치"
      }
    ],
    "WorktreeRemove": [
      {
        "command": "echo '워크트리 정리 완료!'",
        "description": "정리 알림"
      }
    ]
  }
}
\`\`\``,
      checklist: [
        "WorktreeCreate 훅의 용도를 이해한다",
        "WorktreeRemove 훅의 용도를 이해한다",
        "훅으로 의존성 자동 설치를 설정할 수 있다"
      ]
    }
  ],

  quiz: [
    {
      question: "워크트리(Worktree)를 가장 잘 설명한 비유는?",
      options: [
        "책상 위 서류를 치우고 다른 서류를 펼치는 것",
        "옆에 별도의 실험대를 만들어 실험하는 것",
        "다른 교실로 이동해서 공부하는 것"
      ],
      answer: 1,
      explanation: "워크트리는 원본 코드(책상)를 그대로 두고, 별도의 복사본(실험대)에서 작업하는 것입니다. 첫 번째는 브랜치 전환(checkout)에 더 가깝습니다."
    },
    {
      question: "워크트리를 만드는 명령어는?",
      options: [
        "claude --branch",
        "claude --worktree (또는 claude -w)",
        "git checkout -b experiment"
      ],
      answer: 1,
      explanation: "claude --worktree 또는 줄여서 claude -w를 사용하면 .claude/worktrees/ 폴더에 격리된 작업 공간이 생성됩니다."
    },
    {
      question: "워크트리에서 실험이 실패했을 때 해야 할 일은?",
      options: [
        "원본 코드를 복구해야 한다",
        "git reset --hard로 되돌려야 한다",
        "워크트리 폴더만 삭제하면 된다"
      ],
      answer: 2,
      explanation: "워크트리는 원본과 완전히 분리되어 있으므로, 실험에 실패해도 워크트리 폴더만 삭제하면 됩니다. 원본 코드는 처음부터 안전합니다!"
    },
    {
      question: "에이전트 격리(isolation: \"worktree\")를 사용하는 이유는?",
      options: [
        "에이전트 실행 속도를 높이기 위해",
        "여러 에이전트가 같은 파일을 동시에 수정하면 충돌하니까",
        "에이전트에게 더 많은 권한을 주기 위해"
      ],
      answer: 1,
      explanation: "에이전트 격리를 사용하면 각 에이전트가 자기만의 워크트리에서 독립적으로 작업합니다. 같은 파일을 동시에 수정해도 서로 영향을 주지 않습니다."
    },
    {
      question: "브랜치 전환과 워크트리의 가장 큰 차이는?",
      options: [
        "브랜치 전환이 더 안전하다",
        "워크트리는 동시에 여러 작업 폴더가 존재할 수 있다",
        "브랜치 전환은 Git이 필요 없다"
      ],
      answer: 1,
      explanation: "브랜치 전환은 하나의 폴더에서 파일을 교체하지만, 워크트리는 여러 폴더가 동시에 존재합니다. 덕분에 동시에 여러 작업을 병렬로 진행할 수 있습니다."
    }
  ]
};
