# 브랜치 전환 vs 워크트리 ⭐

> 같은 책상에서 서류를 바꾸는 것 vs 책상을 하나 더 놓는 것, 어떤 게 나을까?

---

## 두 가지 방법의 차이

코드를 실험하거나 새 기능을 만들 때, Git에서는 두 가지 방법을 쓸 수 있습니다.

### 방법 1: 브랜치 전환 (git checkout)

**한 책상에서 서류를 바꿔가며 작업**하는 방식입니다.

```
  시간 1: main 브랜치                시간 2: experiment 브랜치
  ┌──────────────┐                  ┌──────────────┐
  │  나의 책상    │                  │  나의 책상    │
  │              │    서류 교체!     │              │
  │  main 서류   │  ──────────→     │  실험 서류    │
  │  (원본)      │                  │  (실험용)     │
  └──────────────┘                  └──────────────┘

  → 한 번에 하나의 서류만 펼칠 수 있음
  → 전환할 때마다 서류를 치우고 다시 꺼내야 함
```

### 방법 2: 워크트리 (git worktree)

**책상을 하나 더 놓고 동시에 작업**하는 방식입니다.

```
  책상 A: main 브랜치               책상 B: experiment 브랜치
  ┌──────────────┐                  ┌──────────────┐
  │  나의 책상    │                  │  실험 책상    │
  │              │                  │              │
  │  main 서류   │                  │  실험 서류    │
  │  (원본)      │                  │  (복사본)     │
  └──────────────┘                  └──────────────┘

  → 두 서류를 동시에 펼쳐놓을 수 있음
  → 필요할 때 원본을 바로 확인 가능
```

---

## 상세 비교표

| 비교 항목 | 브랜치 전환 | 워크트리 |
|-----------|-----------|---------|
| **비유** | 책상 위 서류를 교체 | 책상을 하나 더 놓기 |
| **작업 폴더 수** | 1개 | 2개 이상 |
| **동시 작업** | 불가능 (전환 필요) | 가능 (각 폴더 독립) |
| **전환 시 발생하는 일** | 파일 내용이 바뀜 | 다른 폴더로 이동만 |
| **진행 중인 작업** | 저장(stash)하거나 커밋해야 전환 가능 | 영향 없음 |
| **디스크 공간** | 적게 사용 | 더 사용 (폴더가 추가되므로) |
| **안전성** | 전환 중 실수 가능 | 완전 격리, 안전 |
| **복잡도** | 간단 | 약간 더 복잡 |

---

## 구체적인 시나리오 비교

### 시나리오: 새 기능을 실험하면서 버그도 수정해야 할 때

**브랜치 전환 방식:**

```
1. main에서 작업 중
2. 새 기능 실험을 위해 experiment 브랜치 생성/전환
   → 진행 중인 작업을 stash 해야 함!
3. 실험 중에 긴급 버그 발견
4. 다시 main으로 전환
   → 또 stash 해야 함!
5. 버그 수정 후 experiment로 돌아가기
   → stash를 되돌려야 함!
6. 혼란...
```

**워크트리 방식:**

```
1. main 폴더에서 작업 중
2. 워크트리 생성 (실험용 폴더가 따로 생김)
3. 실험 폴더에서 자유롭게 실험
4. 긴급 버그? main 폴더로 가서 바로 수정
   → 실험 폴더는 그대로!
5. 수정 끝나면 다시 실험 폴더로 돌아가기
6. 깔끔!
```

---

## 장단점 정리

### 브랜치 전환

**장점:**
- 간단하고 익숙한 방법
- 추가 디스크 공간 불필요
- Git 기본 기능이라 모든 곳에서 사용 가능

**단점:**
- 전환 시 저장하지 않은 작업이 날아갈 수 있음
- 동시에 두 브랜치를 비교하기 어려움
- 빌드 캐시가 전환할 때마다 초기화될 수 있음

### 워크트리

**장점:**
- 완전한 격리 (서로 영향 없음)
- 동시에 여러 작업 가능
- 원본과 실험본을 나란히 비교 가능
- 실패해도 폴더만 삭제하면 끝

**단점:**
- 디스크 공간을 더 사용
- 처음에는 개념이 낯설 수 있음
- Git 저장소에서만 사용 가능

---

## 언제 어떤 걸 쓰면 될까?

### 브랜치 전환이 나은 경우

- 간단한 수정 (파일 1~2개)
- 빠르게 전환하고 돌아오는 작업
- 디스크 공간이 부족할 때
- 혼자 순차적으로 작업할 때

### 워크트리가 나은 경우

- 대규모 실험적 변경
- 여러 기능을 동시에 개발할 때
- 원본 코드를 절대 건드리고 싶지 않을 때
- 에이전트가 격리된 환경에서 작업해야 할 때
- 실패하면 깔끔하게 버리고 싶을 때

---

## 시각적 정리

```mermaid
flowchart LR
    A["코드를 수정하고 싶다!"] --> B{"수정 규모는?"}
    B -->|"작고 간단"| C["브랜치 전환"]
    B -->|"크고 실험적"| D["워크트리"]

    C --> E["git checkout -b feature"]
    D --> F["claude --worktree"]

    E --> G["한 폴더에서 전환하며 작업"]
    F --> H["별도 폴더에서 안전하게 실험"]

    style C fill:#3B82F6,color:#fff
    style D fill:#8B5CF6,color:#fff
```

---

## 정리

```
브랜치 전환: 가볍고 빠르지만, 한 번에 하나만
워크트리:    공간은 좀 더 쓰지만, 완전히 격리되어 안전

→ 클로드 코드에서는 "claude -w" 한 줄이면 워크트리 생성 완료!
```

---

## 다음으로 읽기

- [Step 1 — 첫 워크트리 만들기](../tutorial/step-01-first-worktree.md) — 직접 워크트리를 만들어봅시다
