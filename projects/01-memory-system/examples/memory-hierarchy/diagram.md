# 메모리 계층 구조 다이어그램

## 전체 계층도

```
┌─────────────────────────────────────────────────────────┐
│                    클로드 코드 시작                        │
└───────────────────────┬─────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────┐
│  1단계: 유저 메모리 로드                                   │
│  ~/.claude/CLAUDE.md                                    │
│  (모든 프로젝트에 공통 적용되는 내 규칙)                     │
└───────────────────────┬─────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────┐
│  2단계: 상위 폴더 탐색                                     │
│  현재 폴더에서 루트(/)까지 올라가면서                        │
│  CLAUDE.md, CLAUDE.local.md 수집                        │
│  (워크스페이스 > 프로젝트 그룹 > ...)                       │
└───────────────────────┬─────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────┐
│  3단계: 현재 프로젝트 메모리 로드                            │
│  ./CLAUDE.md          (팀 공유 규칙)                     │
│  ./CLAUDE.local.md    (개인 설정)                        │
│  ./.claude/rules/*.md (모듈식 규칙)                      │
└───────────────────────┬─────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────┐
│  4단계: 자동 메모리 불러오기                                │
│  이전 세션 요약 (있으면)                                   │
└───────────────────────┬─────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────┐
│  모든 메모리가 합쳐져서                                    │
│  시스템 프롬프트로 주입!                                    │
│                                                         │
│  충돌 시: 가까운 것(레벨 높은 것)이 우선                     │
└─────────────────────────────────────────────────────────┘
```

## 우선순위 비교

```
우선순위:  낮음 ◄──────────────────────────────► 높음

┌──────────┐    ┌──────────────┐    ┌──────────────┐
│ 유저     │ << │ 워크스페이스   │ << │ 프로젝트     │
│ 메모리   │    │ 메모리        │    │ 메모리       │
│          │    │              │    │              │
│ 전역     │    │ 작업 공간     │    │ 현재 폴더    │
│ 설정     │    │ 설정         │    │ 설정         │
└──────────┘    └──────────────┘    └──────────────┘

예시: 들여쓰기

  유저: 4칸       워크스페이스: -    프로젝트: 2칸
                                    ▲
                                결과: 2칸!
```

## 파일별 비교

```
┌─────────────────────┬──────────────┬───────────────┐
│       파일          │   git 공유   │     용도       │
├─────────────────────┼──────────────┼───────────────┤
│ ~/.claude/CLAUDE.md │  X (개인용)  │ 전역 개인 설정  │
│ ./CLAUDE.md         │  O (팀 공유) │ 프로젝트 규칙   │
│ ./CLAUDE.local.md   │  X (개인용)  │ 로컬 개인 설정  │
│ .claude/rules/*.md  │  O (팀 공유) │ 모듈식 규칙    │
└─────────────────────┴──────────────┴───────────────┘
```
