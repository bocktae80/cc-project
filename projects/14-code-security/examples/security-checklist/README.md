# 보안 체크리스트 만들기

> 나만의 보안 점검표를 만들어 프로젝트를 안전하게 지키자

---

## 보안 체크리스트란?

비행기 조종사가 이륙 전에 점검표를 확인하는 것처럼, 코드를 배포하기 전에 보안 점검표를 확인합니다.

```
비행기 이륙 전 체크리스트:                코드 배포 전 보안 체크리스트:
  [ ] 연료 충분?                          [ ] 입력 검증 완료?
  [ ] 엔진 정상?                          [ ] 인증 확인 완료?
  [ ] 날개 작동?                          [ ] 비밀번호 해시?
  [ ] 통신 연결?                          [ ] 에러 처리 안전?
  [ ] 비상구 확인?                        [ ] API 키 숨김?
```

---

## 보안 체크리스트 템플릿

아래 템플릿을 복사해서 여러분의 프로젝트에 맞게 수정하세요!

### 1. 입력 검증 (Input Validation)

```
"모든 사용자 입력은 의심하라!" -- 보안의 제1원칙

[ ] 모든 사용자 입력에 검증 로직이 있는가?
[ ] SQL 쿼리에 파라미터화 쿼리(?)를 사용하는가?
[ ] HTML 출력 시 이스케이프 또는 textContent를 사용하는가?
[ ] 파일 업로드 시 확장자/크기를 제한하는가?
[ ] URL 파라미터를 신뢰하지 않는가?
```

### 2. 인증과 인가 (Authentication & Authorization)

```
"문을 잠갔는지, 그리고 올바른 사람만 열 수 있는지"

[ ] 보호된 페이지/API에 인증 미들웨어가 있는가?
[ ] 비밀번호를 bcrypt 등으로 해시하여 저장하는가?
[ ] JWT 토큰에 만료 시간(exp)이 설정되어 있는가?
[ ] 로그인 실패 시 시도 횟수를 제한하는가? (brute force 방지)
[ ] 민감한 작업에 추가 인증(비밀번호 재입력 등)이 있는가?
[ ] 사용자가 자신의 데이터만 접근할 수 있는가? (IDOR 방지)
```

### 3. 데이터 보호 (Data Protection)

```
"비밀은 투명 가방이 아닌 금고에 보관"

[ ] 민감 데이터(비밀번호, 개인정보)가 암호화되어 저장되는가?
[ ] API 키, DB 비밀번호 등이 코드에 직접 작성되지 않았는가?
[ ] 환경변수(.env)가 .gitignore에 포함되어 있는가?
[ ] HTTPS를 사용하는가? (데이터 전송 암호화)
[ ] 불필요한 민감 데이터를 API 응답에 포함하지 않는가?
```

### 4. 에러 처리 (Error Handling)

```
"에러 메시지에 비밀을 담지 않기"

[ ] 에러 메시지에 DB 구조, 파일 경로 등 내부 정보가 노출되지 않는가?
[ ] 에러 스택 트레이스가 사용자에게 보이지 않는가?
[ ] 모든 에러에 적절한 HTTP 상태 코드를 반환하는가?
[ ] try-catch로 예외가 처리되는가?
[ ] 에러 로그가 서버에만 기록되는가?
```

### 5. 의존성 관리 (Dependencies)

```
"내 집은 튼튼해도, 이웃집 벽이 약하면?"

[ ] npm/yarn 패키지에 알려진 취약점이 없는가? (npm audit)
[ ] 사용하지 않는 패키지를 제거했는가?
[ ] 패키지 버전이 최신인가? (특히 보안 패치)
[ ] lock 파일(package-lock.json)이 커밋되어 있는가?
```

### 6. 설정과 배포 (Configuration & Deployment)

```
"공사 끝나면 비계를 치우자"

[ ] 디버그 모드가 꺼져 있는가?
[ ] 기본 관리자 비밀번호를 변경했는가?
[ ] 불필요한 포트/엔드포인트가 닫혀 있는가?
[ ] CORS 설정이 적절한가? (모든 출처 허용이 아닌지)
[ ] Content-Security-Policy 헤더가 설정되어 있는가?
```

---

## Claude에게 체크리스트 만들어달라고 하기

여러분의 프로젝트에 맞는 맞춤형 체크리스트를 Claude에게 요청할 수 있어요!

```
Claude에게 요청:
> 우리 프로젝트는 Express.js + MySQL을 사용하는 블로그 서비스야.
> 사용자 회원가입, 로그인, 글 작성/수정/삭제 기능이 있어.
> 이 프로젝트에 맞는 보안 체크리스트를 만들어줘.
```

```
Claude에게 더 구체적으로:
> 우리 API 엔드포인트 목록이야:
> POST /auth/register
> POST /auth/login
> GET /posts
> POST /posts (인증 필요)
> PUT /posts/:id (인증 필요, 작성자만)
> DELETE /posts/:id (인증 필요, 작성자만)
>
> 각 엔드포인트별로 확인해야 할 보안 항목을 체크리스트로 만들어줘.
```

---

## 예시: 완성된 보안 체크리스트

아래는 간단한 블로그 서비스의 보안 체크리스트 예시입니다.

```
=== 미니 블로그 보안 체크리스트 ===
프로젝트: my-blog
마지막 점검: 2024-01-15
점검자: 김철수

[회원가입 - POST /auth/register]
  [x] 이메일 형식 검증
  [x] 비밀번호 최소 8자 + 복잡성 규칙
  [x] 비밀번호 bcrypt 해시 저장
  [x] 중복 가입 방지
  [ ] 가입 시도 횟수 제한 (TODO: rate limiter 추가)

[로그인 - POST /auth/login]
  [x] SQL 인젝션 방지 (파라미터화 쿼리)
  [x] bcrypt.compare로 비밀번호 비교
  [x] JWT 토큰 발급 (1시간 만료)
  [x] 실패 시 일반적 에러 메시지 ("이메일 또는 비밀번호 오류")
  [x] 5회 실패 시 30분 잠금

[글 목록 - GET /posts]
  [x] SQL 인젝션 방지
  [x] 페이지네이션 (한 번에 1000개 이상 조회 방지)
  [x] 삭제된 글/비공개 글 필터링

[글 작성 - POST /posts]
  [x] 인증 미들웨어 적용
  [x] 입력 검증 (제목 100자, 본문 10000자 제한)
  [x] XSS 방지 (HTML 이스케이프)
  [ ] 이미지 업로드 크기 제한 (TODO: 5MB 제한 추가)

[글 수정 - PUT /posts/:id]
  [x] 인증 미들웨어 적용
  [x] 작성자 본인만 수정 가능 확인
  [x] SQL 인젝션 방지
  [x] XSS 방지

[글 삭제 - DELETE /posts/:id]
  [x] 인증 미들웨어 적용
  [x] 작성자 본인만 삭제 가능 확인
  [x] 실제 삭제 대신 soft delete 적용

[공통]
  [x] HTTPS 적용
  [x] CORS 설정 (허용 도메인만)
  [x] 에러 스택 숨김 (프로덕션)
  [x] .env 파일 gitignore 적용
  [x] npm audit 통과
  [ ] Content-Security-Policy 헤더 (TODO: 다음 스프린트)

결과: 22/24 통과 (91.7%)
미완료: 2건 (rate limiter, CSP 헤더)
```

---

## 체크리스트 활용 팁

### 언제 점검하나요?

| 시점 | 점검 내용 |
|------|----------|
| 새 기능 개발 시 | 해당 기능의 입력 검증, 인증, 데이터 보호 |
| 코드 리뷰 시 | 전체 체크리스트로 교차 검증 |
| 배포 전 | 설정, 에러 처리, 의존성 점검 |
| 정기 점검 (월 1회) | 전체 체크리스트 + 의존성 업데이트 |
| 보안 사고 후 | 전체 재점검 + 체크리스트 항목 추가 |

### 점검 결과 관리

```
보안 점검 기록 예시:

날짜        | 점검자 | 결과     | 미완료 항목
----------- |------- |---------|------------
2024-01-15  | 김철수 | 22/24   | rate limiter, CSP
2024-02-01  | 이영희 | 23/24   | CSP (rate limiter 완료!)
2024-03-01  | 김철수 | 24/24   | 모두 완료!
```

---

## 학습 포인트

이 실습을 통해 배우는 것:

1. **체계적 접근**: 보안은 "느낌"이 아니라 체크리스트로 점검
2. **우선순위**: 모든 것을 한 번에 할 필요 없이, 위험한 것부터
3. **반복**: 체크리스트는 한 번이 아니라 정기적으로 점검
4. **맞춤화**: 프로젝트마다 필요한 항목이 다름

> 핵심 교훈: "보안은 완벽할 수 없지만, 체크리스트로 빈틈을 줄일 수 있다!"

---

## 관련 자료

- [취약 코드 샘플](../vulnerable-code/) -- 체크리스트로 발견할 수 있는 취약점 예시
- [스캔+수정 실습](../scan-and-fix/) -- 취약점 수정 워크플로우
- [Step 1: 취약점 이해](../../tutorial/step-01-understand-vulns.md) -- 기본 취약점 학습
