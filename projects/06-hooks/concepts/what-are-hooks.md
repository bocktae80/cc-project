# Hooks란 무엇인가? 🪝

> 클로드의 행동에 자동으로 반응하는 스크립트를 달아보자!

---

## Hooks = 자동 반응 스크립트

학교에서 **자동문**을 본 적 있나요?

- 사람이 다가가면 → 문이 **자동으로** 열립니다
- 사람이 지나가면 → 문이 **자동으로** 닫힙니다

아무도 버튼을 누르지 않아도, **센서가 감지해서 자동으로** 동작하죠.

**Hooks**도 마찬가지입니다:

- 클로드가 파일을 쓰려고 하면 → 훅이 **자동으로** 확인합니다
- 클로드가 도구를 사용하면 → 훅이 **자동으로** 기록합니다

```
🏫 학교 자동문                    🤖 클로드 Hooks
━━━━━━━━━━━━━━━                 ━━━━━━━━━━━━━━━
센서가 사람을 감지               훅이 도구 사용을 감지
  → 문 열림                       → 스크립트 실행
  → 문 닫힘                       → 결과에 따라 허용/차단
```

---

## 4종 훅 상세 설명

### 1. PreToolUse — 도구 사용 전 🚪

**언제:** 클로드가 도구를 사용하기 **직전**에 실행됩니다.

**특징:** 유일하게 **차단**할 수 있는 훅! (`exit 2`로 차단)

**활용 예시:**
- 중요한 파일 수정 막기
- 위험한 명령어 실행 전 경고
- 특정 도구 사용 기록

```
💡 비유: 놀이공원 키 재기
   키가 120cm 미만이면 → 🚫 탑승 불가! (exit 2)
   키가 120cm 이상이면 → ✅ 탑승 가능! (exit 0)
```

### 2. PostToolUse — 도구 사용 후 📝

**언제:** 클로드가 도구를 사용한 **직후**에 실행됩니다.

**특징:** 차단 불가. 결과를 확인하고 기록하는 용도.

**활용 예시:**
- 도구 사용 내역 로깅
- 파일 수정 후 자동 백업
- 변경 사항 알림 보내기

```
💡 비유: 마트 영수증
   물건을 살 때마다 → 📋 영수증 자동 출력
   이미 산 걸 되돌리진 못하지만, 기록은 남김!
```

### 3. Notification — 알림 발생 시 🔔

**언제:** 클로드가 사용자에게 알림을 보낼 때 실행됩니다.

**특징:** 차단 불가. 알림을 다른 곳으로 전달할 때 유용.

**활용 예시:**
- 슬랙/디스코드로 알림 전달
- 데스크탑 알림 표시
- 알림 로그 저장

```
💡 비유: 학교 방송
   교장 선생님이 방송하면 → 📢 각 교실 스피커에서 자동 재생
```

### 4. Stop — 대화 종료 시 🏫

**언제:** 클로드와의 대화가 끝날 때 실행됩니다.

**특징:** 차단 불가. 정리 작업에 유용.

**활용 예시:**
- 세션 요약 저장
- 임시 파일 정리
- 작업 시간 기록

```
💡 비유: 하교 벨
   땡! 벨이 울리면 → 🧹 교실 청소, 📚 가방 정리
```

---

## 환경변수 상세

훅 스크립트가 실행될 때, 클로드가 **환경변수**를 통해 정보를 전달합니다.

### CLAUDE_TOOL_NAME

사용된 도구의 이름입니다.

```bash
# 예시 값들
CLAUDE_TOOL_NAME="Write"    # 파일 쓰기
CLAUDE_TOOL_NAME="Edit"     # 파일 수정
CLAUDE_TOOL_NAME="Bash"     # 터미널 명령어
CLAUDE_TOOL_NAME="Read"     # 파일 읽기
CLAUDE_TOOL_NAME="Glob"     # 파일 검색
```

### CLAUDE_TOOL_INPUT

도구에 전달된 입력값입니다. **JSON 형식**으로 제공됩니다.

```json
// Write 도구의 입력 예시
{
  "file_path": "/Users/me/project/hello.txt",
  "content": "Hello, World!"
}

// Edit 도구의 입력 예시
{
  "file_path": "/Users/me/project/app.js",
  "old_string": "console.log('old')",
  "new_string": "console.log('new')"
}
```

### CLAUDE_TOOL_RESULT

도구 실행 결과입니다. **PostToolUse에서만** 사용 가능!

```bash
# PreToolUse에서는 아직 도구가 실행되지 않았으므로 비어있음!
# PostToolUse에서만 결과를 볼 수 있음
```

> ⚠️ **주의:** PreToolUse에서 `CLAUDE_TOOL_RESULT`를 읽으면 비어있어요!
> 도구가 아직 실행되기 전이니까요.

---

## settings.json에서 설정하는 법

훅은 `.claude/settings.json` 파일에 설정합니다.

### 기본 구조

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "도구이름",
        "hook": "실행할 명령어"
      }
    ],
    "PostToolUse": [
      {
        "matcher": "도구이름",
        "hook": "실행할 명령어"
      }
    ]
  }
}
```

### 설정 요소 설명

| 요소 | 설명 | 예시 |
|------|------|------|
| `matcher` | 어떤 도구에 반응할지 | `"Write"`, `"Edit"`, `"Bash"` |
| `hook` | 실행할 스크립트/명령어 | `"echo 'Hello'"`, `"./guard.sh"` |

### matcher 사용법

```json
// 특정 도구에만 반응
{ "matcher": "Write", "hook": "echo '파일 작성!'" }

// 모든 도구에 반응 (matcher 생략 또는 빈 문자열)
{ "matcher": "", "hook": "echo '도구 사용됨!'" }
```

### 여러 훅 등록하기

```json
{
  "hooks": {
    "PreToolUse": [
      { "matcher": "Write", "hook": "echo '📝 파일 작성!'" },
      { "matcher": "Bash", "hook": "echo '⚠️ 터미널 명령어!'" },
      { "matcher": "Edit", "hook": "./check-edit.sh" }
    ]
  }
}
```

> 💡 같은 종류의 훅에 여러 개를 등록할 수 있어요. 배열(`[]`) 안에 여러 객체를 넣으면 됩니다!

---

## 핵심 정리

```
🪝 Hooks 개념 요약
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  ✅ Hooks = 도구 사용에 자동으로 반응하는 스크립트
  ✅ 4종류: PreToolUse, PostToolUse, Notification, Stop
  ✅ 차단 가능한 건 PreToolUse뿐! (exit 2)
  ✅ 환경변수로 도구 정보를 받음
  ✅ .claude/settings.json에 설정
```
