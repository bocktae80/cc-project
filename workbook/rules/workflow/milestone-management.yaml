id: milestone-management-001
name: 마일스톤 관리 원칙
description: |
  새로운 업무 시작 시 로드맵 마일스톤 등록을 보장하고,
  마일스톤 완료 시 시맨틱 버전과 연결하는 규칙.
category: workflow
tags: [마일스톤, 로드맵, milestone, roadmap, planning, 작업시작, version, 버전]
severity: warning

claude_summary:
  - "**신규 작업 감지**: 기존 마일스톤에 없는 새 모듈/기능 작업 시작 시 마일스톤 추가 제안"
  - "**분기 감지**: 진행 중 스코프가 확장되거나 새 서브시스템이 생기면 마일스톤 분리 제안"
  - "**기록 필수**: 마일스톤 없이 코드 작성 시작 금지 — 최소 항목명 + 상태 테이블"
  - "**넘버링**: M{N} (메인), M{N}.{x} (서브). 예: M8, M6.2"
  - "**버전 연결**: 메인 마일스톤 완료 → minor +1, 서브 마일스톤 → patch +1, breaking → major +1"
  - "**완료 배포**: 마일스톤 완료 → 설계문서 + TECHNICAL.md + USER-GUIDE.md 업데이트 → 커밋 → 푸시 → 플러그인 업데이트"

rules:
  new_work_detection:
    description: "새 작업 시작 시 마일스톤 확인"
    items:
      - "새 디렉토리/모듈을 생성하기 전에 ROADMAP.md의 현재/다음 마일스톤을 확인한다"
      - "현재 마일스톤 항목에 해당 작업이 없으면, 사용자에게 새 마일스톤 추가를 제안한다"
      - "제안 형식: '이 작업은 현재 마일스톤(M{N})에 없습니다. 새 마일스톤으로 추가할까요?'"
      - "사용자가 승인하면 ROADMAP.md에 마일스톤 섹션을 즉시 추가한다"
      - "사용자가 거절하면 기존 마일스톤 항목에 추가하거나, 미배정으로 진행한다"

  scope_branching:
    description: "진행 중 분기 감지"
    items:
      - "작업 중 새로운 서브시스템/패키지/config 디렉토리가 생기면 분기 여부를 판단한다"
      - "원래 마일스톤 스코프를 벗어나는 경우, 별도 마일스톤 분리를 제안한다"
      - "config/ 또는 새 레이어 추가는 거의 항상 별도 마일스톤 후보이다"

  milestone_format:
    description: "마일스톤 기록 형식"
    items:
      - "최소 항목: 마일스톤 제목, 목표(1줄), 항목|설명|상태 테이블, 완료일(완료 시)"
      - "넘버링: M{N} (메인 마일스톤), M{N}.{x} (서브 마일스톤). 예: M8, M6.2"
      - "ROADMAP.md의 '완료된 마일스톤' 또는 '현재 마일스톤' 섹션에 배치"

  version_strategy:
    description: "마일스톤-시맨틱 버전 연결"
    items:
      - "메인 마일스톤(M8, M9 등) 완료 → package.json minor 버전 +1"
      - "서브 마일스톤(M3.7, M6.2 등) 완료 → package.json patch 버전 +1"
      - "비기능 변경(포맷, 문서 등) → patch +1"
      - "Breaking change (API 호환성 깨짐) → major +1"
      - "ROADMAP.md의 '버전 전략' 섹션에 버전 이력을 기록한다"
      - "커밋 메시지에 버전 범프를 명시한다: 'chore: v1.3.0 → v1.4.0 (M8 완료)'"

  milestone_completion_delivery:
    description: "마일스톤 완료 시 문서 + 커밋 + 배포"
    items:
      - "마일스톤 완료 시 다음을 반드시 수행한다:"
      - "  1. ROADMAP.md 업데이트: 완료 표기 + 완료 기준 달성 표시 + 완료 섹션에 요약 추가"
      - "  2. 전용 설계 문서 작성/업데이트: workbook/plan/designs/PLAN-{feature}.md (배경, 설계 결정, API, 파일 인벤토리)"
      - "  3. 전체 아키텍처 문서 업데이트: docs/TECHNICAL.md에 신규 모듈/매니저/타입 반영"
      - "  4. 전체 가이드 문서 업데이트: docs/USER-GUIDE.md에 신규 기능 사용법 반영"
      - "  5. ROADMAP.md artifacts 주석에 설계/테스트/시나리오/아키텍처/가이드 경로 등록"
      - "  6. 커밋: 모든 변경사항을 하나의 커밋으로 묶어 생성"
      - "  7. 푸시: 리모트에 푸시"
      - "  8. 플러그인 업데이트 (해당 시): 플러그인 프로젝트면 npm run update 또는 캐시 갱신"
      - "사용자가 '작업 반영해줘', '커밋하고 배포해줘', '마무리해줘' 등으로 요청하면 위 전체를 수행한다"
      - "문서가 이미 최신이면 해당 단계를 건너뛴다"

  roadmap_output_format:
    description: "로드맵 출력 형식"
    items:
      - "마크다운 테이블 사용 (정렬은 렌더러가 처리)"
      - "목록 템플릿: 마일스톤 | 타이틀 | 내용 | 상태 | 날짜"
      - "상세 템플릿: 아이템 | 타이틀 | 내용 | 상태 | 날짜"
      - "프로그레스 바: █░ 20칸 (5% 단위) + 퍼센트/완료/대기"
      - "테이블 셀 안에 이모지 사용 금지 (폭 불일치로 정렬 깨짐)"
      - "마일스톤 번호순 표시 (상태별 그룹이 아님)"
      - "스코프아웃: 75%* + 테이블 하단 각주 (* M4: 4건 스코프아웃)"

examples:
  good:
    - |
      # 좋은 예: 마일스톤 완료 시 버전 범프
      M10 완료 → package.json v1.2.0 → v1.3.0
      커밋: "chore: v1.3.0 범프 (M10 Multi-Repo Worktree 완료)"
    - |
      # 좋은 예: 서브 마일스톤 완료
      M6.2 완료 → v1.3.0 → v1.3.1
      커밋: "chore: v1.3.1 범프 (M6.2 Console Redesign 완료)"
    - |
      # 좋은 예: 새 모듈 작성 전 마일스톤 제안
      "이 작업은 현재 마일스톤(M8)에 없습니다. 새 마일스톤으로 추가할까요?"
    - |
      # 좋은 예: 마일스톤 완료 시 문서 + 배포
      M12 완료 → PLAN-plan-system-enhancement.md 작성
      → TECHNICAL.md에 WorkItemResolver, session-conflict 등 반영
      → USER-GUIDE.md에 자동 감지, 충돌 경고 사용법 반영
      → 커밋 → 푸시 → 플러그인 업데이트
  bad:
    - "나쁜 예: 마일스톤 완료 후 버전 범프 없이 다음 작업 시작"
    - "나쁜 예: 마일스톤 확인 없이 대규모 작업 후 뒤늦게 로드맵에 추가"
    - "나쁜 예: 마일스톤 완료 후 코드만 커밋하고 아키텍처/가이드 문서 업데이트 누락"

exceptions:
  - "5분 이하 소규모 수정 (버그 픽스, 리팩토링)은 마일스톤/버전 범프 불필요"
  - "기존 마일스톤 항목의 구현 세부 작업은 별도 마일스톤 불필요"

metadata:
  version: "3.0.0"
  status: active
  author: "@kent"
  source: builtin
created: "2026-02-15T00:00:00Z"
updated: "2026-02-16T00:00:00Z"
scope: workspace
enabled: true
